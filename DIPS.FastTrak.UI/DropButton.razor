<button class="DropButton @GetCssClass()" @onclick="HandleClick">
    <div class="Content" >
        @ChildContent
    </div>
    <svg width="16" height="16" viewBox="0 0 24 24">
        <path d="M4.22 8.47a.75.75 0 0 1 1.06 0L12 15.19l6.72-6.72a.75.75 0 1 1 1.06 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L4.22 9.53a.75.75 0 0 1 0-1.06Z" />
    </svg>
</button>

@code {
    [CascadingParameter]
    internal IPopupControl? PopupControl { get; set; }

    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    [Parameter]
    public EventCallback OnClick { get; set; }

    [Parameter]
    public bool PillShape { get; set; }

    private string GetCssClass()
    {
        var css = "";
        if (PillShape) css += "PillShape ";
        if (PopupControl?.GetIsOpen() == true) css += "IsOpen";
        return css;
    }

    private async Task HandleClick(MouseEventArgs e)
    {
        if (PopupControl != null)
        {
            if (PopupControl.GetIsOpen())
                await PopupControl.CloseAsync();
            else
                await PopupControl.OpenAsync();
        }
        await OnClick.InvokeAsync();
    }
}